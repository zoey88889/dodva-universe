<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dodva Â· æç®€ç™½å™ªéŸ³æ§åˆ¶å°</title>
<style>
  :root{--bg:#0b0f1a;--fg:#eaf2ff;--sub:#a3b4d8;--line:rgba(147,197,253,.18)}
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans SC",sans-serif}
  header{padding:14px 16px;border-bottom:1px solid var(--line)}
  h1{margin:0;font-size:20px}
  .wrap{max-width:1000px;margin:0 auto;padding:18px 14px 60px}
  .grid{display:grid;gap:14px}
  @media (min-width:880px){.grid{grid-template-columns:1fr 1fr}}
  section{border:1px solid var(--line);border-radius:14px;padding:14px;background:rgba(147,197,253,.06)}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  select,button,input[type=range]{background:rgba(147,197,253,.08);border:1px solid var(--line);color:var(--fg);padding:8px 10px;border-radius:10px}
  button{cursor:pointer}
  .hint{font-size:13px;color:var(--sub)}
  .card{border:1px solid var(--line);border-radius:12px;padding:12px;background:rgba(147,197,253,.04);margin-top:10px}
  .card h4{margin:0 0 8px 0}
  .state{font-size:13px;color:var(--sub);min-height:1.4em}
</style>
</head>
<body>
<header><h1>Dodva Â· æç®€ç™½å™ªéŸ³æ§åˆ¶å°</h1></header>

<div class="wrap">
  <div class="grid">
    <!-- åŠŸèƒ½1ï½œå•çº¯ç™½å™ªéŸ³ï¼ˆå•è½¨å¿«æ·æ’­æ”¾ï¼šä½ çš„æ—§ç‰ˆï¼‰ -->
    <section>
      <h3>åŠŸèƒ½1ï½œå•çº¯ç™½å™ªéŸ³ï¼ˆå•è½¨ï¼‰</h3>
      <div class="row" style="margin:6px 0 10px">
        <label>åœºæ™¯ï¼š
          <select id="quickSel">
            <option value="off">å…³é—­</option>
            <option value="forest">ğŸŒ³ æ£®æ—</option>
            <option value="rain">ğŸŒ§ï¸ é›¨å£°</option>
            <option value="ocean">ğŸŒŠ æµ·æ´‹</option>
            <option value="relax">ğŸ”Š èˆ’ç¼“/é¢‘ç‡</option>
          </select>
        </label>
        <button id="quickPlay">â–¶ æ’­æ”¾</button>
        <button id="quickStop">â¹ åœæ­¢</button>
        <label>éŸ³é‡ <input id="quickVol" type="range" min="0" max="1" step="0.01" value="0.30"></label>
      </div>
      <div id="quickState" class="state">æç¤ºï¼šé¦–æ¬¡éœ€ç‚¹ä»»æ„æŒ‰é’®æˆæƒéŸ³é¢‘ã€‚</div>
      <div class="hint">ä¸€æ¬¡åªæ’­æ”¾ä¸€ä¸ªåœºæ™¯ï¼ˆæœ€æ¥è¿‘ä½ ç¬¬ä¸€ç‰ˆçš„ä½¿ç”¨æ–¹å¼ï¼‰ã€‚</div>
    </section>

    <!-- åŠŸèƒ½2ï½œç²¾ç®€æ··éŸ³å®éªŒå®¤ï¼ˆå¤šè½¨å åŠ ï¼šæˆ‘çš„æ–°ç‰ˆï¼‰ -->
    <section>
      <h3>åŠŸèƒ½2ï½œæ··éŸ³å®éªŒå®¤ï¼ˆå¤šè½¨å åŠ ï¼‰</h3>

      <div class="card" data-bank="forest">
        <h4>ğŸŒ³ æ£®æ—</h4>
        <div class="row">
          <button class="toggle">å¼€å¯</button>
          <label>éŸ³é‡ <input class="vol" type="range" min="0" max="1" step="0.01" value="0.35"></label>
        </div>
        <div class="state">å†…å®¹ï¼šè™«é¸£ / æ—å¶é£ / è¿œæºªå£°ï¼ˆéšæœºå…¶ä¸€ï¼‰</div>
      </div>

      <div class="card" data-bank="rain">
        <h4>ğŸŒ§ï¸ é›¨å£°</h4>
        <div class="row">
          <button class="toggle">å¼€å¯</button>
          <label>éŸ³é‡ <input class="vol" type="range" min="0" max="1" step="0.01" value="0.30"></label>
        </div>
        <div class="state">å†…å®¹ï¼šçª—æ²¿é›¨ / è¿œé›·ï¼ˆéšæœºå…¶ä¸€ï¼‰</div>
      </div>

      <div class="card" data-bank="ocean">
        <h4>ğŸŒŠ æµ·æ´‹</h4>
        <div class="row">
          <button class="toggle">å¼€å¯</button>
          <label>éŸ³é‡ <input class="vol" type="range" min="0" max="1" step="0.01" value="0.30"></label>
        </div>
        <div class="state">å†…å®¹ï¼šæµ·æµª / æµ·é£ï¼ˆéšæœºå…¶ä¸€ï¼‰</div>
      </div>

      <div class="card" data-bank="relax">
        <h4>ğŸ”Š èˆ’ç¼“/é¢‘ç‡</h4>
        <div class="row">
          <button class="toggle">å¼€å¯</button>
          <label>éŸ³é‡ <input class="vol" type="range" min="0" max="1" step="0.01" value="0.20"></label>
        </div>
        <div class="state">å†…å®¹ï¼šå£ç‚‰ / å¤ªç©ºå—¡é¸£ / å¿ƒè·³40Hz / 528Hzï¼ˆéšæœºå…¶ä¸€ï¼‰</div>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="stopAll">â¹ ä¸€é”®å…¨åœ</button>
        <span class="hint">å¯åŒæ—¶å¼€å¯å¤šè½¨ï¼ŒæŒ‰ä½ å–œæ¬¢è‡ªç”±å åŠ ã€‚</span>
      </div>
    </section>
  </div>

  <p class="hint" style="margin-top:14px">
  
  </p>
</div>

<script>
(function(){
  // â€”â€” ç´ æè·¯å¾„ï¼ˆä¸ä½ çš„ç›®å½•ä¸€è‡´ï¼‰â€”â€”
  const BANKS = {
    forest: [
      'assets/audio/forest/crickets.mp3',
      'assets/audio/forest/leaves-wind.mp3',
      'assets/audio/forest/stream-soft.mp3'
    ],
    rain: [
      'assets/audio/rain/window-rain.mp3',
      'assets/audio/rain/distant-thunder.mp3'
    ],
    ocean: [
      'assets/audio/ocean/waves-1.mp3',
      'assets/audio/ocean/wind-sea.mp3'
    ],
    relax: [
      'assets/audio/relax/fireplace-1.mp3',
      'assets/audio/relax/space-hum-60hz.mp3',
      'assets/audio/relax/heart-40hz.mp3',
      'assets/audio/relax/528hz.mp3'
    ]
  };

  const LABELS = { forest:'æ£®æ—', rain:'é›¨å£°', ocean:'æµ·æ´‹', relax:'èˆ’ç¼“/é¢‘ç‡' };
  const pick = arr => arr[Math.floor(Math.random()*arr.length)];
  const clamp01 = v => Math.max(0, Math.min(1, Number(v)||0));

  // ========= åŠŸèƒ½1ï½œå•çº¯ç™½å™ªéŸ³ï¼ˆå•è½¨ï¼‰ =========
  const quickSel   = document.getElementById('quickSel');
  const quickPlay  = document.getElementById('quickPlay');
  const quickStop  = document.getElementById('quickStop');
  const quickVol   = document.getElementById('quickVol');
  const quickState = document.getElementById('quickState');

  const quickAudio = new Audio();
  quickAudio.loop = true; quickAudio.preload = 'auto';
  quickAudio.volume = clamp01(quickVol.value);

  quickPlay.addEventListener('click', async ()=>{
    const key = quickSel.value;
    if (key === 'off') { stopQuick(); return; }
    const list = BANKS[key]; if (!list) return;
    quickAudio.src = pick(list);
    quickAudio.volume = clamp01(quickVol.value);
    try{
      await quickAudio.play();
      quickState.textContent = 'æ­£åœ¨æ’­æ”¾ï¼š' + (LABELS[key]||key);
    }catch(e){
      quickState.textContent = 'æç¤ºï¼šè¯·å…ˆç‚¹å‡»æœ¬æŒ‰é’®æˆæƒéŸ³é¢‘å†æ’­æ”¾';
      console.warn(e);
    }
  });

  function stopQuick(){
    quickAudio.pause();
    quickAudio.removeAttribute('src');
    quickAudio.load();
    quickState.textContent = 'å·²åœæ­¢';
  }
  quickStop.addEventListener('click', stopQuick);
  quickVol.addEventListener('input', e=> quickAudio.volume = clamp01(e.target.value));

  // ========= åŠŸèƒ½2ï½œæ··éŸ³å®éªŒå®¤ï¼ˆå¤šè½¨å åŠ ï¼‰ =========
  const mixers = {}; // key -> {audio,on,volEl,stateEl,btn}
  document.querySelectorAll('.card[data-bank]').forEach(card=>{
    const key     = card.dataset.bank;
    const btn     = card.querySelector('.toggle');
    const volEl   = card.querySelector('.vol');
    const stateEl = card.querySelector('.state');

    const a = new Audio();
    a.loop = true; a.preload = 'auto'; a.volume = clamp01(volEl.value);
    mixers[key] = { audio:a, on:false, volEl, stateEl, btn };

    btn.addEventListener('click', async ()=>{
      if (!mixers[key].on){
        const list = BANKS[key]; if (!list) return;
        a.src = pick(list);
        a.volume = clamp01(volEl.value);
        try{
          await a.play();
          mixers[key].on = true;
          btn.textContent = 'å·²å¼€å¯';
          stateEl.textContent = `æ’­æ”¾ä¸­ï¼š${LABELS[key]||key}`;
        }catch(e){
          stateEl.textContent = 'æç¤ºï¼šå…ˆç‚¹ä¸€æ¬¡æŒ‰é’®ä»¥æˆæƒéŸ³é¢‘';
          console.warn(e);
        }
      }else{
        a.pause(); a.removeAttribute('src'); a.load();
        mixers[key].on = false;
        btn.textContent = 'å¼€å¯';
        stateEl.textContent = 'å·²åœæ­¢';
      }
    });

    volEl.addEventListener('input', e=>{
      a.volume = clamp01(e.target.value);
    });
  });

  document.getElementById('stopAll').addEventListener('click', ()=>{
    // åœæ··éŸ³
    Object.values(mixers).forEach(m=>{
      try{ m.audio.pause(); m.audio.removeAttribute('src'); m.audio.load();
           m.on=false; m.btn.textContent='å¼€å¯'; m.stateEl.textContent='å·²åœæ­¢'; }catch(_){}
    });
    // åœå•è½¨
    stopQuick();
  });

  // ç¦»å¼€é¡µé¢æ—¶å®‰å…¨åœæ­¢
  window.addEventListener('pagehide', ()=>{
    stopQuick();
    Object.values(mixers).forEach(m=>{ try{ m.audio.pause(); }catch(_){ } });
  });
})();
</script>
<footer style="text-align:center; color:#ccc; margin-top:20px; font-size:14px;">
  Coded with love for Xinyue Â· by Dodva ğŸ’«
</footer>
</body>
</html>
