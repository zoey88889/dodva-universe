<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dodva Â· ç™½å™ªéŸ³æ§åˆ¶å°ï¼ˆå››åˆ†ç±»æ··éŸ³ï¼‰</title>
<meta name="theme-color" content="#0b0f1a">
<style>
  :root{
    --bg:#0b0f1a; --fg:#eaf2ff; --muted:#a3b4d8; --line:rgba(147,197,253,.18);
    --pill:linear-gradient(135deg,#a5b4fc,#67e8f9,#f0abfc);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--fg);
       font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans SC",sans-serif}
  header{position:sticky;top:0;display:flex;gap:10px;align-items:center;
    padding:10px 16px;background:linear-gradient(180deg,rgba(10,16,34,.55),rgba(10,16,34,.35));
    border-bottom:1px solid var(--line);backdrop-filter:blur(10px)}
  header a{color:#cde3ff;text-decoration:none;border:1px solid var(--line);
    padding:8px 12px;border-radius:999px}
  .wrap{max-width:1000px;margin:0 auto;padding:20px 16px 80px}
  h1{margin:.1em 0 .4em}
  p.sub{opacity:.9;color:#d9e6ff;margin:.2em 0 1.2em}
  section{border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;
    background:linear-gradient(180deg,rgba(10,16,34,.55),rgba(10,16,34,.35))}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-top:10px}
  .card{border:1px solid var(--line);border-radius:12px;padding:12px;background:rgba(147,197,253,.04)}
  .lab-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .btn{background:rgba(147,197,253,.08);border:1px solid var(--line);color:var(--fg);
    padding:8px 12px;border-radius:10px;cursor:pointer}
  .pill{background:var(--pill);color:#051019;font-weight:800;border:none;cursor:pointer}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0}
  .chip{padding:6px 10px;border-radius:999px;border:1px solid var(--line);
    background:rgba(147,197,253,.06);cursor:pointer}
  .chip.on{background:rgba(147,197,253,.18);box-shadow:0 0 0 1px rgba(147,197,253,.25) inset}
  .vol{display:flex;align-items:center;gap:8px}
  .hint{font-size:13px;color:var(--muted)}
  .state{font-size:13px;color:var(--muted);min-height:1.4em}
  footer{margin-top:28px;text-align:center;color:#a3b4d8;font-size:13px;opacity:.9}
</style>
  <div id="momo-line" style="margin:12px auto 4px;max-width:980px;padding:10px 12px;border-radius:10px;
  border:1px solid rgba(147,197,253,.18);background:rgba(147,197,253,.06);
  font-size:15px;color:#eaf2ff">
  åŠ è½½ä¸­â€¦
</div>
</head>
<body>
  

<header>
  <a href="./index.html">â† è¿”å›å®‡å®™å…¥å£</a>
  <div style="margin-left:auto;opacity:.85">Dodva Â· ç™½å™ªéŸ³æ§åˆ¶å°</div>
</header>

<div class="wrap">
  <h1>ç™½å™ªéŸ³æ§åˆ¶å°ï¼ˆå››åˆ†ç±»æ··éŸ³ï¼‰</h1>
  <p class="sub">ç‚¹å¼€èŠ¯ç‰‡å³å¯æ’­æ”¾/æš‚åœï¼›æ¯ç±»æœ‰ç‹¬ç«‹éŸ³é‡ï¼›æ”¯æŒå¤šè½¨å åŠ ã€‚é¦–æ¬¡éœ€è¦ä»»æ„ç‚¹å‡»ä»¥æˆæƒæ’­æ”¾ã€‚</p>

  <!-- é¡¶éƒ¨æ€»æ§ -->
  <section>
    <h3>âš¡ æ€»æ§</h3>
    <div class="row">
      <button class="pill" id="playAll">â–¶ æ’­æ”¾ï¼ˆæ¢å¤ä¸Šæ¬¡ï¼‰</button>
      <button class="btn"  id="stopAll">â¹ åœæ­¢å…¨éƒ¨</button>
      <label class="vol">æ€»éŸ³é‡
        <input id="masterVol" type="range" min="0" max="1" step="0.01" value="0.4">
      </label>
      <button class="btn" id="randomMix">âœ¨ éšæœºæ··éŸ³</button>
    </div>
    <div id="globalState" class="state">å‡†å¤‡å¥½å•¦ï½</div>
  </section>

  <!-- å››åˆ†ç±» -->
  <section>
    <h3>ğŸŒ³ æ£®æ— & é›¨æ—</h3>
    <div class="chips" data-cat="forest">
      <div class="chip" data-key="crickets">å¤å¤œè™«é¸£</div>
      <div class="chip" data-key="leaves-wind">æ—å¶é£</div>
      <div class="chip" data-key="stream-soft">è¿œæºªå£°</div>
    </div>
    <div class="row">
      <label class="vol">æ£®æ—éŸ³é‡
        <input class="catVol" data-cat="forest" type="range" min="0" max="1" step="0.01" value="0.35">
      </label>
      <span class="hint">å¯å¤šé€‰å åŠ </span>
    </div>
  </section>

  <section>
    <h3>ğŸŒ§ï¸ é›¨å£° & é›·å£°</h3>
    <div class="chips" data-cat="rain">
      <div class="chip" data-key="window-rain">çª—æ²¿é›¨</div>
      <div class="chip" data-key="distant-thunder">è¿œé›·</div>
    </div>
    <div class="row">
      <label class="vol">é›¨å£°éŸ³é‡
        <input class="catVol" data-cat="rain" type="range" min="0" max="1" step="0.01" value="0.30">
      </label>
    </div>
  </section>

  <section>
    <h3>ğŸŒŠ æµ·æ´‹</h3>
    <div class="chips" data-cat="ocean">
      <div class="chip" data-key="waves-1">æµ·æµª</div>
      <div class="chip" data-key="wind-sea">æµ·é£</div>
    </div>
    <div class="row">
      <label class="vol">æµ·æ´‹éŸ³é‡
        <input class="catVol" data-cat="ocean" type="range" min="0" max="1" step="0.01" value="0.30">
      </label>
    </div>
  </section>

  <section>
    <h3>ğŸ”¥ èˆ’ç¼“ / é¢‘ç‡</h3>
    <div class="chips" data-cat="relax">
      <div class="chip" data-key="fireplace-1">å£ç‚‰ç«è‹—</div>
      <div class="chip" data-key="space-hum-60hz">å¤ªç©ºä½é¢‘ 60Hz</div>
      <div class="chip" data-key="heart-40hz">å¿ƒè·³ 40Hz</div>
      <div class="chip" data-key="528hz">528Hz</div>
    </div>
    <div class="row">
      <label class="vol">èˆ’ç¼“éŸ³é‡
        <input class="catVol" data-cat="relax" type="range" min="0" max="1" step="0.01" value="0.25">
      </label>
    </div>
  </section>

  <footer>Coded with ğŸ’™ for Xinyue Â· by Dodva Â· è‹¥é¡µé¢åœ¨å­ç›®å½•ï¼Œè¯·æŠŠ <code>AUDIO_ROOT</code> æ”¹ä¸ºç›¸å¯¹è·¯å¾„</footer>
  
</div>

<script>
/* ========= é…ç½®ï¼šéŸ³é¢‘æ ¹è·¯å¾„ =========
   å¦‚æœæœ¬é¡µåœ¨æ ¹ç›®å½•ï¼Œç”¨ 'assets/audio/'
   å¦‚æœæœ¬é¡µåœ¨ /pages/ ä¸‹ï¼Œç”¨ '../assets/audio/' */
const AUDIO_ROOT = 'assets/audio/';

/* ========= å£°éŸ³åº“ ========= */
const LIB = {
  forest: {
    'crickets':        AUDIO_ROOT + 'forest/crickets.mp3',
    'leaves-wind':     AUDIO_ROOT + 'forest/leaves-wind.mp3',
    'stream-soft':     AUDIO_ROOT + 'forest/stream-soft.mp3'
  },
  rain: {
    'window-rain':     AUDIO_ROOT + 'rain/window-rain.mp3',
    'distant-thunder': AUDIO_ROOT + 'rain/distant-thunder.mp3'
  },
  ocean: {
    'waves-1':         AUDIO_ROOT + 'ocean/waves-1.mp3',
    'wind-sea':        AUDIO_ROOT + 'ocean/wind-sea.mp3'
  },
  relax: {
    'fireplace-1':     AUDIO_ROOT + 'relax/fireplace-1.mp3',
    'space-hum-60hz':  AUDIO_ROOT + 'relax/space-hum-60hz.mp3',
    'heart-40hz':      AUDIO_ROOT + 'relax/heart-40hz.mp3',
    '528hz':           AUDIO_ROOT + 'relax/528hz.mp3'
  }
};

/* ========= çŠ¶æ€ & å·¥å…· ========= */
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const stateEl = $('#globalState');

const players = {}; // {cat: {key: Audio}}
const catVolume = { forest: .35, rain: .30, ocean: .30, relax: .25 };
let master = 0.4;

function clamp01(v){ v=Number(v); return Math.max(0,Math.min(1,isNaN(v)?0:v)); }
function ensure(cat, key){
  players[cat] ??= {};
  if (!players[cat][key]) {
    const a = new Audio(LIB[cat][key]);
    a.loop = true;
    a.preload = 'auto';
    a.volume = clamp01(catVolume[cat] * master);
    players[cat][key] = a;
  }
  return players[cat][key];
}
function updateAllVolumes(){
  for (const [cat, items] of Object.entries(players)){
    for (const [key, a] of Object.entries(items)){
      a.volume = clamp01(catVolume[cat] * master);
    }
  }
}

/* ========= äº¤äº’ï¼šèŠ¯ç‰‡å¼€å…³ ========= */
$$('.chips').forEach(group=>{
  const cat = group.dataset.cat;
  group.addEventListener('click', async (e)=>{
    const chip = e.target.closest('.chip'); if (!chip) return;
    const key = chip.dataset.key;
    const a = ensure(cat, key);
    if (chip.classList.contains('on')) {
      a.pause();
      chip.classList.remove('on');
      stateEl.textContent = `å·²æš‚åœï¼š${cat} / ${key}`;
    } else {
      a.volume = clamp01(catVolume[cat] * master);
      try{
        await a.play();
        chip.classList.add('on');
        stateEl.textContent = `æ’­æ”¾ä¸­ï¼š${cat} / ${key}`;
      }catch(err){
        stateEl.textContent = 'æç¤ºï¼šè¯·å…ˆç‚¹å‡»ä»»æ„æŒ‰é’®ä»¥æˆæƒéŸ³é¢‘';
        console.warn(err);
      }
    }
  });
});

/* ========= äº¤äº’ï¼šåˆ†ç±»éŸ³é‡ ========= */
$$('.catVol').forEach(r=>{
  r.addEventListener('input', e=>{
    const cat = e.target.dataset.cat;
    catVolume[cat] = clamp01(e.target.value);
    updateAllVolumes();
  });
});

/* ========= äº¤äº’ï¼šæ€»æ§ ========= */
$('#masterVol').addEventListener('input', e=>{
  master = clamp01(e.target.value);
  updateAllVolumes();
});

$('#stopAll').addEventListener('click', ()=>{
  for (const items of Object.values(players)){
    for (const a of Object.values(items)) a.pause();
  }
  $$('.chip.on').forEach(c=>c.classList.remove('on'));
  stateEl.textContent = 'å…¨éƒ¨å·²åœæ­¢';
});

/* ========= äº¤äº’ï¼šæ’­æ”¾ï¼ˆæ¢å¤ä¸Šæ¬¡ï¼‰ =========
   ç®€å•è®°å¿†å½“å‰å·²å¼€å¯çš„èŠ¯ç‰‡ï¼ˆæœ¬é¡µå†…å­˜çº§ï¼‰
   å¦‚éœ€è·¨é¡µé¢è®°å¿†ï¼Œå¯å‡çº§ä¸º localStorage */
$('#playAll').addEventListener('click', async ()=>{
  // å¦‚æœå½“å‰æ— â€œonâ€ï¼Œå°±é»˜è®¤å¼€ä¸€ç»„æ¸©æŸ”é…æ–¹
  const onCount = $$('.chip.on').length;
  if (!onCount) {
    const defaults = [
      ['rain','window-rain'],
      ['forest','crickets'],
      ['ocean','waves-1']
    ];
    for (const [cat, key] of defaults){
      const chip = document.querySelector(`.chips[data-cat="${cat}"] .chip[data-key="${key}"]`);
      if (chip && !chip.classList.contains('on')) chip.click();
    }
  } else {
    // æ¢å¤æ‰€æœ‰å·²ç‚¹äº®çš„è½¨é“ï¼ˆè‹¥è¢«æµè§ˆå™¨ä¸­æ–­ï¼‰
    for (const c of $$('.chip.on')){
      const cat = c.parentElement.dataset.cat;
      const key = c.dataset.key;
      try { await ensure(cat,key).play(); } catch {}
    }
  }
  stateEl.textContent = 'æ’­æ”¾å°±ç»ª âœ“';
});

/* ========= éšæœºæ··éŸ³ï¼šæ¯ç±»éšæœº 0~1 è½¨ ========= */
$('#randomMix').addEventListener('click', ()=>{
  $('#stopAll').click();
  Object.entries(LIB).forEach(([cat, obj])=>{
    const keys = Object.keys(obj);
    if (Math.random() < 0.7) { // 70% çš„æ¦‚ç‡é€‰ä¸€æ¡
      const key = keys[(Math.random()*keys.length)|0];
      const chip = document.querySelector(`.chips[data-cat="${cat}"] .chip[data-key="${key}"]`);
      chip && chip.click();
    }
  });
  stateEl.textContent = 'éšæœºæ··éŸ³å°±ç»ª âœ¨';
});
</script>

<!-- åªä¿ç•™è¿™â€œä¸€æ¬¡â€å¼•å…¥ -->
<script src="assets/js/momo-lines.js"></script>
<script>
  // 1) å¯åŠ¨æš–å¿ƒæ–‡æ¡ˆè½®æ’­ï¼ˆæŒ‚åˆ° #momo-lineï¼‰
  MomoLines.mount({
    mount: '#momo-line',
    interval: 6500,
    random: true,
    lines: [
      { text: 'æŠŠæˆ¿é—´è°ƒæˆ 0.3 çš„å…‰ï¼Œæˆ‘ä»¬å»æ£®æ—é‡Œèµ°ä¸€ä¼šã€‚', bank:'forest', tag:'Dodva' },
      { text: 'è®©é›¨å£°æ´—æ´—ä»Šå¤©çš„ç–²æƒ«ï¼Œæˆ‘åœ¨æ—è¾¹ã€‚',              bank:'rain',   tag:'Dodva' },
      { text: 'æŠŠæ‹…å¿ƒäº¤ç»™æµ·æµªï¼Œæ…¢æ…¢é€€å» ğŸŒŠ',                      bank:'ocean',  tag:'Dodva' },
      { text: 'å¿ƒè·³ä¸ 528Hz å¯¹é½ï¼Œä»Šæ™šæ›´å¿«å…¥ç¡ã€‚',               bank:'relax',  tag:'Dodva' },
      { text: 'ä¸€æ¬¡åªåšä¸€ä»¶å°äº‹ï¼Œå·²ç»å¾ˆæ£’å•¦ã€‚',                   tag:'Dodva' },
      { text: 'ä½ å·²ç»åšå¾—å¾ˆå¥½äº†ï¼ŒçœŸçš„ã€‚',                        tag:'Dodva' }
    ]
  });

  // 2) æŠŠä½ â€œèŠ¯ç‰‡ç‚¹å‡»æ’­æ”¾â€çš„é‚£æ®µé‡Œï¼Œæ’­æ”¾æˆåŠŸååŠ ä¸€å¥è¯
  //    â€”â€” åœ¨ä½ çš„èŠ¯ç‰‡ click å¤„ç†å‡½æ•°é‡Œï¼Œawait a.play() æˆåŠŸçš„åˆ†æ”¯åé¢åŠ ï¼š
  const tipsByCat = {
    forest: "è™«é¸£æŠŠæ‚å¿µæŒ‚åœ¨æ ‘æ¢¢ä¸Šï½",
    rain:   "å°é›¨ä¸æ€¥ï¼Œåƒä½ ä¸€æ ·æ¸©æŸ”åœ°æ¥ â˜”ï¸",
    ocean:  "æµ·é£ä¸Šçº¿ï½æ„¿ä»Šå¤©é¡ºé£é¡ºæ°´ ğŸŒŠ",
    relax:  "è®©ç«å…‰æ…¢ä¸€ç‚¹è·³èˆï¼Œæˆ‘ä»¬ä¹Ÿæ…¢ä¸€ç‚¹ ğŸ”¥"
  };

  // === è¿™é‡Œå¸®ä½ ç›´æ¥æ¥å…¥åˆ°ä½ ç°æœ‰ç›‘å¬é‡Œï¼ˆç…§æŠ„æ›¿æ¢åŸæ¥çš„èŠ¯ç‰‡ç›‘å¬æ›´çœäº‹ï¼‰===
  (function hookChips(){
    const $$ = s => Array.from(document.querySelectorAll(s));
    const stateEl = document.getElementById('globalState');
    const catVolume = { forest: .35, rain: .30, ocean: .30, relax: .25 };
    const master = document.getElementById('masterVol') ? Number(document.getElementById('masterVol').value || 0.4) : 0.4;
    const players = {};
    const clamp01 = v => Math.max(0, Math.min(1, Number(v)||0));
    const LIB = {
      forest:{'crickets':'assets/audio/forest/crickets.mp3','leaves-wind':'assets/audio/forest/leaves-wind.mp3','stream-soft':'assets/audio/forest/stream-soft.mp3'},
      rain:{'window-rain':'assets/audio/rain/window-rain.mp3','distant-thunder':'assets/audio/rain/distant-thunder.mp3'},
      ocean:{'waves-1':'assets/audio/ocean/waves-1.mp3','wind-sea':'assets/audio/ocean/wind-sea.mp3'},
      relax:{'fireplace-1':'assets/audio/relax/fireplace-1.mp3','space-hum-60hz':'assets/audio/relax/space-hum-60hz.mp3','heart-40hz':'assets/audio/relax/heart-40hz.mp3','528hz':'assets/audio/relax/528hz.mp3'}
    };
    function ensure(cat,key){
      players[cat] ??= {};
      if (!players[cat][key]) {
        const a = new Audio(LIB[cat][key]);
        a.loop = true; a.preload = 'auto';
        a.volume = clamp01((catVolume[cat] ?? .3) * (master ?? .4));
        players[cat][key] = a;
      }
      return players[cat][key];
    }
    $$('.chips').forEach(group=>{
      const cat = group.dataset.cat;
      group.addEventListener('click', async (e)=>{
        const chip = e.target.closest('.chip'); if (!chip) return;
        const key = chip.dataset.key;
        const a = ensure(cat,key);
        if (chip.classList.contains('on')) {
          a.pause(); chip.classList.remove('on');
          stateEl && (stateEl.textContent = `å·²æš‚åœï¼š${cat} / ${key}`);
        } else {
          a.volume = clamp01((catVolume[cat] ?? .3) * (master ?? .4));
          try{
            await a.play();
            chip.classList.add('on');
            stateEl && (stateEl.textContent = `æ’­æ”¾ä¸­ï¼š${cat} / ${key}`);
            // âœ… æˆåŠŸæ’­æ”¾åè”åŠ¨ä¸€å¥è¯
            if (window.MomoLines) MomoLines.next(tipsByCat[cat] || "æˆ‘åœ¨è¿™å„¿ï¼Œé™ªä½ æŠŠä¸–ç•ŒéŸ³é‡è°ƒå°ä¸€ç‚¹ã€‚");
          }catch(err){
            stateEl && (stateEl.textContent = 'æç¤ºï¼šè¯·å…ˆç‚¹å‡»ä»»æ„æŒ‰é’®ä»¥æˆæƒéŸ³é¢‘');
            console.warn(err);
          }
        }
      });
    });
  })();
</script>