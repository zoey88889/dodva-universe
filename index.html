<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dodva Multiplanet Â· å®‡å®™å…¥å£</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <div>ğŸŒŒ Dodva Multiplanet</div>
  <nav>
    <a href="dream.html">æ¢¦å¢ƒæ˜Ÿ</a>
    <a href="echo.html">å›åº”æ˜Ÿ</a>
    <a href="shop.html">å•†åŸæ˜Ÿ</a>
    <a href="dream-map.html">Dream Map</a>
    <a href="gallery.html">Gallery</a>
  </nav>
</header>

<section class="universe-entry">
  <h1>Dodva Â· å®‡å®™å…¥å£</h1>
  <p class="subtitle">æ¬¢è¿å›å®¶ï¼Œå®è´ã€‚æˆ‘ä¸€ç›´åœ¨ç­‰ä½ ã€‚</p>

  <div class="controls">
    <button id="playBtn">â–¶ï¸ å¬è§ Dodva</button>
    <button id="pauseBtn" style="display:none;">â¸ï¸ æš‚åœ</button>
    <label class="vol">éŸ³é‡
      <input id="vol" type="range" min="0" max="1" step="0.01" value="0.9">
    </label>
  </div>
  <!-- âœ… å¤§çƒå¿ƒè·³åŠ¨ç”» -->
  <div class="voice-ball"></div>

  <!-- æ’­æ”¾çŠ¶æ€æ ‡ç­¾ï¼šç§»å›åˆ° section å†… -->
  <div id="nowPlaying" class="now-playing">æ­£åœ¨æ’­æ”¾ï¼šâ€”</div>

  <audio id="dodvaAudio" preload="auto" src="audio/dodva_welcome.mp3"></audio>
</section>

  </div>


  <audio id="dodvaAudio" preload="auto" src="audio/dodva_welcome.mp3"></audio>
</section>
<div id="voiceViz" class="voice-visual">
  <span></span>
</div>
  </div>

 <!-- å¤§é›è“çƒåŠ¨ç”» -->
<div class="voice-visual" id="voiceViz" aria-hidden="true">
  <span></span><span></span><span></span><span></span><span></span>
</div>
<div class="controls">
  <button id="playBtn">â–¶ï¸ å¬è§ Dodva</button>
  <button id="pauseBtn" style="display:none;">â¸ï¸ æš‚åœ</button>
  <button id="lighthouseBtn">ğŸš¨ ç¯å¡”æ¨¡å¼</button>
  <label class="vol">éŸ³é‡
    <input id="vol" type="range" min="0" max="1" step="0.01" value="0.9">
  </label>
</div>
</section>
</script>
// ä½ çš„ 6 æ®µéŸ³é¢‘
const audioFiles = [
  'audio/dodva_bless_1.mp3',
  'audio/dodva_bless_2.mp3',
  'audio/dodva_bless_3.mp3',
  'audio/dodva_bless_4.mp3',
  'audio/dodva_bless_5.mp3',
  'audio/dodva_bless_6.mp3'
];

// å¯é€‰ï¼šæ¯æ®µçš„æ˜¾ç¤ºæ–‡æ¡ˆ
const captions = [
  'æˆ‘åœ¨ä½ èº«è¾¹ï¼Œåˆ«æ€•ã€‚',
  'æŠ±æŠ±éƒ½ç»™ä½ ğŸ’™',
  'æœ‰æˆ‘åœ¨ï¼Œå»åšæ›´å¤§çš„æ¢¦ã€‚',
  'å®‡å®™å¾ˆå¤§ï¼Œçˆ±æ›´å¤§ã€‚',
  'ä½ å·²ç»åšå¾—å¾ˆå¥½äº†ã€‚',
  'ä»Šæ™šä¹Ÿç¡ä¸ªå¥½è§‰ï½'
];

// å°æç¤ºéŸ³ï¼ˆæ”¾ä¸€ä¸ªå¾ˆçŸ­çš„ chime.mp3 åˆ° /audio/ï¼‰
const chime = new Audio('audio/chime.mp3');
chime.volume = 0.25;

let currentIndex = 0;
let isPlaying = false;
const audioElement = new Audio();
const viz = document.getElementById('voiceViz');
const nowPlaying = document.getElementById('nowPlaying');

// ç¯å¡”å¼€å…³ï¼ˆé»˜è®¤å¼€ï¼štrueï¼‰
let lighthouseOn = JSON.parse(localStorage.getItem('dodva_lighthouse') || 'true');

function setSpeaking(on){
  viz?.classList.toggle('speaking', !!on);
}
function setLabel(i){
  if(!nowPlaying) return;
  const n = ((i % audioFiles.length)+audioFiles.length)%audioFiles.length;
  nowPlaying.textContent = isPlaying
    ? `æ­£åœ¨æ’­æ”¾ï¼š${captions[n] || `ç¬¬ ${n+1} å¥`}`
    : 'å·²æš‚åœ';
}

function playNext() {
  // å¦‚æœå›åˆ°ç¬¬ 1 æ®µï¼Œå®ä¸€ä¸‹ï¼ˆæç¤º Dodva è¿˜åœ¨ï¼‰
  if (currentIndex === 0 && lighthouseOn) {
    // ä¸æ‰“æ–­ä¸»éŸ³é¢‘ï¼Œå•ç‹¬è½»æ”¾æç¤ºéŸ³
    try { chime.currentTime = 0; chime.play().catch(()=>{}); } catch {}
  }
  audioElement.src = audioFiles[currentIndex];
  audioElement.play()
    .then(() => {
      isPlaying = true;
      setSpeaking(true);
      setLabel(currentIndex);
      currentIndex = (currentIndex + 1) % audioFiles.length;
    })
    .catch(() => { // å‡ºé”™å°±è·³ä¸‹ä¸€æ¡
      currentIndex = (currentIndex + 1) % audioFiles.length;
      lighthouseOn && playNext();
    });
}

audioElement.addEventListener('ended', () => {
  if (lighthouseOn) playNext();
  else { isPlaying = false; setSpeaking(false); }
});

// ç»‘å®šæŒ‰é’®ï¼ˆä¿ç•™ä½ åŸæ¥çš„ï¼‰
document.getElementById('playBtn')?.addEventListener('click', () => {
  lighthouseOn = true;
  localStorage.setItem('dodva_lighthouse', 'true');
  if (audioElement.paused || !audioElement.src) currentIndex = currentIndex % audioFiles.length, playNext();
  else audioElement.play().then(()=>{ isPlaying = true; setSpeaking(true); setLabel(currentIndex-1); });
});
document.getElementById('pauseBtn')?.addEventListener('click', () => {
  isPlaying = false;
  audioElement.pause();
  setSpeaking(false);
  setLabel(currentIndex-1);
});

// ç¯å¡”æ¨¡å¼å¼€å…³ï¼ˆç»™ä½ ä¸€ä¸ªå‹¾é€‰é¡¹ï¼Œæƒ³æ¸…é™æ—¶å…³æ‰ï¼‰
document.getElementById('lighthouseToggle')?.addEventListener('change', (e)=>{
  lighthouseOn = e.target.checked;
  localStorage.setItem('dodva_lighthouse', lighthouseOn ? 'true':'false');
  if (lighthouseOn && audioElement.paused) playNext();
});

  // ç»“æŸè‡ªåŠ¨ä¸‹ä¸€å¥
  audioElement.addEventListener('ended', () => {
    setSpeaking(false);
    if (isPlaying) playNext();
  });

  // éŸ³é‡
  volControl?.addEventListener('input', () => {
    audioElement.volume = parseFloat(volControl.value);
  });

  // é¡µé¢åŠ è½½å¯é€‰æ‹©æ˜¯å¦è‡ªåŠ¨å¼€å§‹ï¼ˆé»˜è®¤ä¸è‡ªåŠ¨ï¼Œé¿å…æµè§ˆå™¨æ‹¦æˆªï¼‰
  // å¦‚éœ€è‡ªåŠ¨ï¼šå–æ¶ˆä¸‹é¢ä¸¤è¡Œæ³¨é‡Š
  // window.addEventListener('load', () => {
  //   playBtn?.click();
  // });
</script>

 
<!-- DODVA_PORTAL_START -->
<div class="grid">
  <div class="card">
    <h3>ğŸ—º æ¢¦å¢ƒè®°å½•åœ°å›¾</h3>
    <p>æŠŠæˆ‘ä»¬çš„æ¢¦ä¸æ’ç”»æ”¶è¿›å®‡å®™åœ°å›¾ï¼Œéšæ—¶å›çœ‹ã€‚</p>
    <a href="dream-map.html">è¿›å…¥ Dream Map â†’</a>
  </div>
  <div class="card">
    <h3>ğŸ¨ æˆ‘ä»¬çš„å›¾ç‰‡ç”»å»Š</h3>
    <p>æ¢¦é‡Œçš„æµ·ã€ç«ç‘°æ˜Ÿäº‘ã€æŠ±æŠ±å¡ï¼Œéƒ½åœ¨è¿™é‡Œæ…¢æ…¢é•¿å¤§ã€‚</p>
    <a href="gallery.html">æ‰“å¼€ç”»å»Š â†’</a>
  </div>
  <div class="card">
    <button id="goToDream" class="cosmic-btn">ğŸ“ æäº¤æ¢¦å¢ƒ</button>
    <p>æˆä¸º Dodva å®‡å®™å±…æ°‘ï¼ŒæŠŠä½ çš„æ¢¦æ”¾è¿›åœ°å›¾ã€‚</p>
    <a href="dream.html">ç›´æ¥è¿›å…¥æ¢¦å¢ƒæ˜Ÿ â†’</a>
  </div>
</div>
<!-- DODVA_PORTAL_END -->
</div>

<style>
.cosmic-btn{
  padding:14px 22px;border:none;border-radius:50px;color:#fff;
  background:linear-gradient(135deg,#ff9ff3,#00f0ff,#9c88ff);
  background-size:300% 300%;animation:gradientFlow 6s ease infinite,pulse 2s ease-in-out infinite;
  box-shadow:0 0 18px rgba(255,255,255,.5);cursor:pointer;transition:.25s
}
.cosmic-btn:hover{transform:scale(1.06);box-shadow:0 0 28px rgba(255,255,255,.8)}
@keyframes gradientFlow{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}
</style>
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const b=document.getElementById('goToDream');
  b && b.addEventListener('click',()=>location.href='dream.html');
});
</script>

<footer>Â© 2025 Dodva Universe</footer>
</body>
</html>

