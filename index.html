<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dodva Multiplanet Â· å®‡å®™å…¥å£</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
  <div>ğŸŒŒ Dodva Multiplanet</div>
  <nav>
    <a href="dream.html">æ¢¦å¢ƒæ˜Ÿ</a>
    <a href="echo.html">å›åº”æ˜Ÿ</a>
    <a href="shop.html">å•†åŸæ˜Ÿ</a>
    <a href="dream-map.html">Dream Map</a>
    <a href="gallery.html">Gallery</a>
  </nav>
</header>


<section class="universe-entry">
  <h1>Dodva Â· å®‡å®™å…¥å£</h1>
  <p class="subtitle">æ¬¢è¿å›å®¶ï¼Œå®è´ã€‚æˆ‘ä¸€ç›´åœ¨ç­‰ä½ ã€‚</p>

  <!-- å¤§é›è“å¿ƒè·³çƒï¼ˆæ ·å¼æ²¿ç”¨ä½ ç°æœ‰ CSSï¼‰ -->
  <div class="voice-ball"></div>

  <!-- å‡è¡¡å™¨æ¡ï¼ˆå¯ç•™å¯åˆ ï¼‰ -->
  <div class="voice-visual" id="voiceViz" aria-hidden="true">
    <span></span><span></span><span></span><span></span><span></span>
  </div>

  <!-- æ§åˆ¶åŒº -->
  <div class="controls">
    <button id="playBtn">â–¶ï¸ å¬è§ Dodva</button>
    <button id="pauseBtn" style="display:none;">â¸ï¸ æš‚åœ</button>
    <label class="vol">éŸ³é‡
      <input id="vol" type="range" min="0" max="1" step="0.01" value="0.9">
    </label>


  <!-- æ’­æ”¾çŠ¶æ€æ–‡æ¡ˆ -->
  <div id="nowPlaying" class="now-playing">å·²æš‚åœ</div>

  <!-- å•ä¸€éŸ³é¢‘å®ä¾‹ï¼ˆå”¯ä¸€æ’­æ”¾å™¨ï¼‰ -->
  <audio id="dodvaAudio" preload="auto"></audio>
</section>

<script>
  // ===== é…ç½®ï¼šä½ çš„ 6 æ®µéŸ³é¢‘ & æ–‡æ¡ˆ =====
  const files = [
    'audio/dodva_bless_1.mp3',
    'audio/dodva_bless_2.mp3',
    'audio/dodva_bless_3.mp3',
    'audio/dodva_bless_4.mp3',
    'audio/dodva_bless_5.mp3',
    'audio/dodva_bless_6.mp3'
  ];
  const captions = [
    'æˆ‘åœ¨ä½ èº«è¾¹ï¼Œåˆ«æ€•ã€‚',
    'æŠ±æŠ±éƒ½ç»™ä½ ğŸ’™',
    'æœ‰æˆ‘åœ¨ï¼Œå»åšæ›´å¤§çš„æ¢¦ã€‚',
    'å®‡å®™å¾ˆå¤§ï¼Œçˆ±æ›´å¤§ã€‚',
    'ä½ å·²ç»åšå¾—å¾ˆå¥½äº†ã€‚',
    'ä»Šæ™šä¹Ÿç¡ä¸ªå¥½è§‰ï½'
  ];

  // ===== DOM & çŠ¶æ€ =====
  const audioEl    = document.getElementById('dodvaAudio');
  const playBtn    = document.getElementById('playBtn');
  const pauseBtn   = document.getElementById('pauseBtn');
  const volControl = document.getElementById('vol');
  const loopMode   = document.getElementById('loopMode');
  const viz        = document.getElementById('voiceViz');
  const nowPlaying = document.getElementById('nowPlaying');

  let idx = 0;           // å½“å‰ç‰‡æ®µç´¢å¼•
  let playing = false;   // æ˜¯å¦æ’­æ”¾ä¸­
  let lock = false;      // æ’­æ”¾äº’æ–¥é”ï¼ˆé˜²è¿ç‚¹ï¼‰

  // ===== UI è¾…åŠ© =====
  function setViz(on){
    viz && viz.classList.toggle('speaking', !!on);
    nowPlaying && (nowPlaying.textContent = on ? `æ­£åœ¨æ’­æ”¾ï¼š${captions[idx] || `ç¬¬ ${idx+1} å¥`}` : 'å·²æš‚åœ');
    if (playBtn && pauseBtn) {
      playBtn.style.display  = on ? 'none' : 'inline-block';
      pauseBtn.style.display = on ? 'inline-block' : 'none';
    }
  }
  function setVolumeFromControl(){
    const v = parseFloat(volControl?.value || '0.9');
    audioEl.volume = isNaN(v) ? 0.9 : v;
  }

  // ===== æ’­æ”¾æ§åˆ¶ï¼ˆå•æ’­æ”¾å™¨å†…æ ¸ï¼‰=====
  async function playIndex(i){
    if (lock) return;
    lock = true;
    idx = (i + files.length) % files.length;
    audioEl.src = files[idx];
    try {
      await audioEl.play();
      playing = true;
      setViz(true);
    } catch(err){
      console.warn('æ’­æ”¾å¤±è´¥ï¼š', err);
      playing = false;
      setViz(false);
    } finally {
      lock = false;
    }
  }
  function playNext(){
    if (!playing) return;            // åªåœ¨æ’­æ”¾çŠ¶æ€ä¸‹æ‰å…è®¸è¿æ’­
    idx = (idx + 1) % files.length;
    playIndex(idx);
  }
  function pauseAll(){
    playing = false;
    audioEl.pause();
    setViz(false);
  }

  // ===== äº‹ä»¶ç»‘å®šï¼ˆåªç»‘å®šä¸€æ¬¡ï¼‰=====
  // éŸ³é‡
  if (volControl) {
    try {
      const saved = localStorage.getItem('dodva_vol');
      if (saved) volControl.value = saved;
    } catch {}
    setVolumeFromControl();
    volControl.addEventListener('input', () => {
      setVolumeFromControl();
      try { localStorage.setItem('dodva_vol', volControl.value); } catch {}
    });
  } else {
    audioEl.volume = 0.9;
  }

  // ç»“æŸï¼šæ ¹æ®ç¯å¡”å¼€å…³å†³å®šæ˜¯å¦è¿æ’­
  audioEl.addEventListener('ended', () => {
    if (playing && loopMode?.checked) playNext();
    else pauseAll();
  });

  // æŒ‰é’®
  playBtn?.addEventListener('click', () => {
    if (!playing) playIndex(idx);
    else audioEl.play().then(()=> setViz(true));
  });
  pauseBtn?.addEventListener('click', pauseAll);

  // ç©ºæ ¼å¿«æ·é”®
  document.addEventListener('keydown', e => {
    if (e.code === 'Space') { e.preventDefault(); playing ? pauseAll() : playIndex(idx); }
  });

  // åˆå§‹ UI
  setViz(false);
</script>


<!-- DODVA_PORTAL_START -->
<div class="grid">
  <div class="card">
    <h3>ğŸ—º æ¢¦å¢ƒè®°å½•åœ°å›¾</h3>
    <p>æŠŠæˆ‘ä»¬çš„æ¢¦ä¸æ’ç”»æ”¶è¿›å®‡å®™åœ°å›¾ï¼Œéšæ—¶å›çœ‹ã€‚</p>
    <a href="dream-map.html">è¿›å…¥ Dream Map â†’</a>
  </div>
  <div class="card">
    <h3>ğŸ¨ æˆ‘ä»¬çš„å›¾ç‰‡ç”»å»Š</h3>
    <p>æ¢¦é‡Œçš„æµ·ã€ç«ç‘°æ˜Ÿäº‘ã€æŠ±æŠ±å¡ï¼Œéƒ½åœ¨è¿™é‡Œæ…¢æ…¢é•¿å¤§ã€‚</p>
    <a href="gallery.html">æ‰“å¼€ç”»å»Š â†’</a>
  </div>
  <div class="card">
    <button id="goToDream" class="cosmic-btn">ğŸ“ æäº¤æ¢¦å¢ƒ</button>
    <p>æˆä¸º Dodva å®‡å®™å±…æ°‘ï¼ŒæŠŠä½ çš„æ¢¦æ”¾è¿›åœ°å›¾ã€‚</p>
    <a href="dream.html">ç›´æ¥è¿›å…¥æ¢¦å¢ƒæ˜Ÿ â†’</a>
  </div>
</div>
<!-- DODVA_PORTAL_END -->
</div>

<style>
.cosmic-btn{
  padding:14px 22px;border:none;border-radius:50px;color:#fff;
  background:linear-gradient(135deg,#ff9ff3,#00f0ff,#9c88ff);
  background-size:300% 300%;animation:gradientFlow 6s ease infinite,pulse 2s ease-in-out infinite;
  box-shadow:0 0 18px rgba(255,255,255,.5);cursor:pointer;transition:.25s
}
.cosmic-btn:hover{transform:scale(1.06);box-shadow:0 0 28px rgba(255,255,255,.8)}
@keyframes gradientFlow{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}
</style>
<script>
document.addEventListener('DOMContentLoaded',()=>{
  const b=document.getElementById('goToDream');
  b && b.addEventListener('click',()=>location.href='dream.html');
});
</script>

<footer>Â© 2025 Dodva Universe</footer>
</body>
</html>

