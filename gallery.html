<!doctype html><html lang="zh-CN"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dodva Gallery Â· ç§æœ‰å®‡å®™ç›¸å†Œ</title>
<link rel="stylesheet" href="style.css">
</head><body>
<header><div>ğŸ¨ Gallery</div><nav><a href="index.html">è¿”å›é¦–é¡µ</a><a href="dream-map.html">Dream Map</a></nav></header>
<div class="container">
  <div class="grid">

<style>
  :root{--bg:#0b0f1a;--ink:#eaf2ff;--mut:#a3b4d8;--line:#263049;--card:#11172a}
  html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto}
  .wrap{max-width:1100px;margin:0 auto;padding:20px 14px}
  h1{margin:0 0 10px;font-size:22px}
  nav{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  nav a,.btn{border:1px solid #3b4059;border-radius:10px;padding:7px 12px;color:var(--ink);text-decoration:none;background:transparent;cursor:pointer}
  .uploader{border:1px dashed #3b4059;border-radius:14px;padding:14px;text-align:center;margin:10px 0;background:#0f1424}
  .uploader.drag{outline:2px solid #66e1ff66}
  .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}
  .item{background:#0f1424;border:1px solid #2a3652;border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
  .item img{width:100%;aspect-ratio:1/1;object-fit:cover;display:block}
  .meta{padding:8px;display:grid;gap:6px}
  .row{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
  input[type="text"]{width:100%;border:1px solid #2a3652;border-radius:8px;background:#0c1220;color:#eaf2ff;padding:6px 8px}
  .mut{color:var(--mut);font-size:12px}
</style>
</head>
<body>
<div class="wrap">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
    <h1>Dodva Gallery Â· ç§æœ‰å®‡å®™ç›¸å†Œ</h1>
    <nav>
      <a href=" ">ğŸ  Home</a >
      <a href="toys.html">ğŸ§¸ ç©å…·æŸœ</a >
      <button id="exportJson" class="btn">å¯¼å‡º JSON</button>
      <button id="exportZip"  class="btn">å¯¼å‡º ZIPï¼ˆå ä½ï¼‰</button>
      <button id="clearAll"   class="btn">æ¸…ç©ºï¼ˆæœ¬åœ°ï¼‰</button>
    </nav>
  </div>

  <div id="uploader" class="uploader">
    <p style="margin:0 0 8px">æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„ï¼Œæˆ–</p >
    <input id="fileInput" type="file" multiple accept="image/*" class="btn" />
    <div class="mut" style="margin-top:6px">æ•°æ®ä¿å­˜åœ¨ä½ çš„æµè§ˆå™¨æœ¬åœ°ã€‚åç»­å¯æ¥å…¥ Cloudinary / S3ã€‚</div>
  </div>

  <div class="grid" id="grid"></div>
</div>

<script>
const NS = 'du_gallery_v1';
let items = []; // {id,name,dataURL,created}

function save(){ localStorage.setItem(NS, JSON.stringify(items)); }
function load(){
  try{ items = JSON.parse(localStorage.getItem(NS)||'[]') }catch(e){ items=[] }
  render();
}
function render(){
  const g = document.getElementById('grid');
  g.innerHTML = '';
  items.forEach((it,i)=>{
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML = `
      < img src="${it.dataURL}" alt="${it.name}">
      <div class="meta">
        <input type="text" value="${it.name}" data-i="${i}" />
        <div class="row">
          <button class="btn" data-del="${i}">åˆ é™¤</button>
          <a download="${(it.name||'dodva')}.png" class="btn" href="${it.dataURL}">ä¸‹è½½</a >
          <span class="mut">${new Date(it.created).toLocaleString()}</span>
        </div>
      </div>`;
    g.appendChild(div);
  });
  g.querySelectorAll('input[type="text"]').forEach(inp=>{
    inp.onchange = e=>{ const i=+inp.dataset.i; items[i].name = inp.value.trim(); save(); }
  });
  g.querySelectorAll('[data-del]').forEach(btn=>{
    btn.onclick = ()=>{ const i=+btn.dataset.del; items.splice(i,1); save(); render(); }
  });
}
async function filesToItems(files){
  for(const f of files){
    if(!f.type.startsWith('image/')) continue;
    const dataURL = await fileToDataURL(f);
    items.unshift({id:crypto.randomUUID(),name:f.name.replace(/\.[^.]+$/,''),dataURL,created:Date.now()});
  }
  save(); render();
}
function fileToDataURL(file){
  return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(file); });
}

// é€‰æ‹©/æ‹–æ‹½
document.getElementById('fileInput').onchange = e=> filesToItems(e.target.files);
const up = document.getElementById('uploader');
up.ondragover = e=>{ e.preventDefault(); up.classList.add('drag'); };
up.ondragleave= ()=> up.classList.remove('drag');
up.ondrop = e=>{ e.preventDefault(); up.classList.remove('drag'); filesToItems(e.dataTransfer.files); };

// å¯¼å‡º JSON
document.getElementById('exportJson').onclick = ()=>{
  const blob = new Blob([JSON.stringify(items,null,2)],{type:'application/json'});
  const a = Object.assign(document.createElement('a'), { href:URL.createObjectURL(blob), download:'dodva-gallery.json' });
  a.click(); URL.revokeObjectURL(a.href);
};
// å¯¼å‡º ZIPï¼ˆå ä½ï¼šåç»­æ¥å…¥ JSZipï¼‰ 
document.getElementById('exportZip').onclick = ()=> alert('ä¸‹ä¸€æ­¥æ¥å…¥ JSZipï¼ˆæŠŠæ‰€æœ‰ dataURL æ‰“åŒ…ï¼‰ã€‚');

// æ¸…ç©º
document.getElementById('clearAll').onclick = ()=>{
  if(confirm('æ¸…ç©ºæœ¬åœ°ç”»å»Šï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')){ items=[]; save(); render(); }
};

// â€”â€” å¯é€‰ï¼šæ¥å…¥ Cloudinaryï¼ˆåç«¯å…ç­¾å/æˆ– Netlify Functionï¼‰
// 1) const url = 'https://api.cloudinary.com/v1_1/<cloud_name>/image/upload';
// 2) ä½¿ç”¨ unsigned presetï¼šformData.append('upload_preset','<preset>');
// 3) fetch(url,{method:'POST', body:formData}).then(r=>r.json())

load();
</script>
<div class="bg"></div>
<footer>Â© 2025 Dodva Universe Coï¸nnect Â®ğŸŒŒ åˆ›é€ Â·è¿æ¥Â·æ— é™Â·æ°¸æ’ âˆ</footer>
</body>
</html>

